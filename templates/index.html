{% extends 'base.html' %}
{% block title %}Dashboard - Aero Cartola{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="text-center mb-12">
    <div class="inline-flex items-center space-x-3 mb-6">
        <div class="p-3 bg-gradient-to-br from-dark-blue-500 to-dark-blue-600 rounded-xl shadow-lg animate-bounce-subtle">
            <i class="fas fa-futbol text-3xl text-white"></i>
        </div>
        <h1 class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-white via-dark-blue-100 to-dark-blue-200 bg-clip-text text-transparent">
            Aero Cartola
        </h1>
    </div>
    <p class="text-xl text-dark-blue-200 max-w-2xl mx-auto">
        Gerencie seus times do Cartola FC com inteligência artificial e análises avançadas
    </p>
</div>

{% if not has_data %}
    <!-- Getting Started Section -->
    <div class="max-w-4xl mx-auto">
        <!-- Main Action Card -->
        <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-2xl p-8 border border-dark-blue-700/50 shadow-2xl mb-8">
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-green-500 to-green-600 rounded-full mb-6 shadow-lg">
                    <i class="fas fa-rocket text-3xl text-white"></i>
                </div>
                <h2 class="text-3xl font-bold text-white mb-4">Pronto para começar?</h2>
                <p class="text-dark-blue-200 text-lg mb-8 max-w-2xl mx-auto">
                    Execute a análise completa dos jogadores e gere as melhores escalações para seus times automaticamente
                </p>
                <a href="{{ url_for('pagina_inicial') }}" class="inline-flex items-center space-x-3 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-8 py-4 rounded-xl text-lg font-semibold transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl">
                    <i class="fas fa-cog text-xl"></i>
                    <span>Configurar Perfis e Módulos</span>
                </a>
            </div>
        </div>

        <!-- Features Grid -->
        <div class="grid md:grid-cols-3 gap-6 mb-8">
            <div class="bg-gradient-to-br from-dark-blue-800/40 to-dark-blue-900/40 backdrop-blur-sm rounded-xl p-6 border border-dark-blue-700/50 hover:border-dark-blue-600/50 transition-all duration-200 hover:transform hover:scale-105">
                <div class="flex items-center space-x-3 mb-4">
                    <div class="p-2 bg-blue-500/20 rounded-lg">
                        <i class="fas fa-chart-line text-blue-400 text-xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-white">Análise Inteligente</h3>
                </div>
                <p class="text-dark-blue-300">Algoritmos avançados analisam estatísticas e probabilidades para encontrar os melhores jogadores</p>
            </div>

            <div class="bg-gradient-to-br from-dark-blue-800/40 to-dark-blue-900/40 backdrop-blur-sm rounded-xl p-6 border border-dark-blue-700/50 hover:border-dark-blue-600/50 transition-all duration-200 hover:transform hover:scale-105">
                <div class="flex items-center space-x-3 mb-4">
                    <div class="p-2 bg-purple-500/20 rounded-lg">
                        <i class="fas fa-users text-purple-400 text-xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-white">Escalação Automática</h3>
                </div>
                <p class="text-dark-blue-300">Escalações otimizadas considerando orçamento, forma dos jogadores e estratégias específicas</p>
            </div>

            <div class="bg-gradient-to-br from-dark-blue-800/40 to-dark-blue-900/40 backdrop-blur-sm rounded-xl p-6 border border-dark-blue-700/50 hover:border-dark-blue-600/50 transition-all duration-200 hover:transform hover:scale-105">
                <div class="flex items-center space-x-3 mb-4">
                    <div class="p-2 bg-green-500/20 rounded-lg">
                        <i class="fas fa-trophy text-green-400 text-xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-white">Rankings Dinâmicos</h3>
                </div>
                <p class="text-dark-blue-300">Acompanhe rankings atualizados por posição com métricas detalhadas de performance</p>
            </div>
        </div>

        <!-- Info Alert -->
        <div class="bg-gradient-to-r from-blue-900/50 to-indigo-900/50 backdrop-blur-sm border border-blue-500/50 rounded-xl p-6">
            <div class="flex items-start space-x-3">
                <div class="p-2 bg-blue-500/20 rounded-lg">
                    <i class="fas fa-info-circle text-blue-400 text-xl"></i>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-white mb-2">Acompanhe em Tempo Real</h4>
                    <p class="text-blue-200">
                        Agora você pode acompanhar todo o progresso da análise em tempo real! 
                        Veja os cálculos sendo executados e as escalações sendo geradas ao vivo.
                    </p>
                </div>
            </div>
        </div>
    </div>

{% else %}
    <!-- Dashboard with Data -->
    <div class="mb-8">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-3xl font-bold text-white">Dashboard - Rodada {{ rodada }}</h2>
            <div class="flex items-center space-x-2 bg-dark-blue-800/50 backdrop-blur-sm px-4 py-2 rounded-lg border border-dark-blue-700/50">
                <i class="fas fa-calendar-alt text-dark-blue-300"></i>
                <span class="text-dark-blue-200">Rodada {{ rodada }}</span>
            </div>
        </div>

        <!-- Teams Section -->
        <div class="mb-12">
            <div class="flex items-center space-x-3 mb-6">
                <div class="p-2 bg-gradient-to-br from-green-500 to-green-600 rounded-lg">
                    <i class="fas fa-users text-white"></i>
                </div>
                <h3 class="text-2xl font-bold text-white">Times Escalados</h3>
            </div>

            <div class="grid lg:grid-cols-3 md:grid-cols-2 gap-6">
                {% for time in times %}
                <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-xl border border-dark-blue-700/50 shadow-lg hover:shadow-xl transition-all duration-200 overflow-hidden">
                    <!-- Team Header -->
                    <div class="bg-gradient-to-r from-dark-blue-700/80 to-dark-blue-800/80 p-4 border-b border-dark-blue-700/50">
                        <h4 class="text-xl font-bold text-white text-center">{{ time.nome }}</h4>
                        <div class="flex items-center justify-between mt-2">
                            <span class="text-dark-blue-200 text-sm">Estratégia: {{ time.estrategia }}</span>
                            <span class="px-3 py-1 rounded-full text-xs font-medium {% if time.status == 'success' %}bg-green-500/20 text-green-300 border border-green-500/50{% else %}bg-red-500/20 text-red-300 border border-red-500/50{% endif %}">
                                {% if time.status == 'success' %}
                                    <i class="fas fa-check-circle mr-1"></i>Sucesso
                                {% else %}
                                    <i class="fas fa-exclamation-circle mr-1"></i>Erro
                                {% endif %}
                            </span>
                        </div>
                    </div>

                    <div class="p-4">
                        {% if time.escalacao %}
                            <!-- Starters -->
                            <div class="mb-4">
                                <h5 class="text-lg font-semibold text-white mb-3 flex items-center">
                                    <i class="fas fa-star text-yellow-400 mr-2"></i>
                                    Titulares
                                </h5>
                                {% if time.escalacao.atletas %}
                                    <div class="space-y-2">
                                        {% for atleta in time.escalacao.atletas %}
                                        <div class="flex items-center justify-between bg-dark-blue-800/30 rounded-lg p-2">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-dark-blue-300 text-sm font-medium">{{ atleta.posicao }}:</span>
                                                <span class="text-white">{{ atleta.nome }}</span>
                                            </div>
                                            {% if atleta.eh_capitao %}
                                            <span class="bg-yellow-500/20 text-yellow-300 px-2 py-1 rounded text-xs font-medium border border-yellow-500/50">
                                                <i class="fas fa-crown mr-1"></i>C
                                            </span>
                                            {% endif %}
                                        </div>
                                        {% endfor %}
                                    </div>
                                {% else %}
                                    <p class="text-dark-blue-400 text-sm italic">Nenhum titular disponível</p>
                                {% endif %}
                            </div>

                            <!-- Reserves -->
                            {% if time.escalacao.reservas %}
                            <div class="mb-4 border-t border-dark-blue-700/50 pt-4">
                                <h5 class="text-lg font-semibold text-white mb-3 flex items-center">
                                    <i class="fas fa-user-friends text-blue-400 mr-2"></i>
                                    Reservas
                                </h5>
                                <div class="space-y-2">
                                    {% for reserva in time.escalacao.reservas %}
                                    <div class="flex items-center space-x-2 bg-dark-blue-800/20 rounded-lg p-2">
                                        <span class="text-dark-blue-300 text-sm font-medium">{{ reserva.posicao }}:</span>
                                        <span class="text-dark-blue-100">{{ reserva.nome }}</span>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}

                            <!-- Luxury Reserves -->
                            {% if time.escalacao.reservas_luxo %}
                            <div class="border-t border-dark-blue-700/50 pt-4">
                                <h5 class="text-lg font-semibold text-white mb-3 flex items-center">
                                    <i class="fas fa-gem text-purple-400 mr-2"></i>
                                    Reservas de Luxo
                                </h5>
                                <div class="space-y-2">
                                    {% for reserva in time.escalacao.reservas_luxo %}
                                    <div class="flex items-center space-x-2 bg-purple-900/20 rounded-lg p-2 border border-purple-500/30">
                                        <span class="text-purple-300 text-sm font-medium">{{ reserva.posicao }}:</span>
                                        <span class="text-purple-100">{{ reserva.nome }}</span>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}
                        {% else %}
                            <div class="text-center py-8">
                                <i class="fas fa-exclamation-triangle text-yellow-400 text-3xl mb-3"></i>
                                <p class="text-dark-blue-400">Nenhuma escalação disponível</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Rankings Section -->
        {% if tables %}
        <div>
            <div class="flex items-center space-x-3 mb-6">
                <div class="p-2 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-lg">
                    <i class="fas fa-trophy text-white"></i>
                </div>
                <h3 class="text-2xl font-bold text-white">Rankings por Posição</h3>
            </div>

            <div class="grid lg:grid-cols-2 gap-6">
                <!-- Goalkeepers -->
                <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-xl border border-dark-blue-700/50 shadow-lg">
                    <div class="p-4 border-b border-dark-blue-700/50">
                        <h4 class="text-xl font-semibold text-white flex items-center">
                            <i class="fas fa-hand-paper text-green-400 mr-2"></i>
                            Melhores Goleiros
                        </h4>
                    </div>
                    <div class="p-4">
                        <div class="overflow-x-auto">
                            {{ tables.goleiros | safe if tables.goleiros else '<p class="text-dark-blue-400 text-center py-4">Nenhum dado disponível</p>' }}
                        </div>
                    </div>
                </div>

                <!-- Defenders -->
                <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-xl border border-dark-blue-700/50 shadow-lg">
                    <div class="p-4 border-b border-dark-blue-700/50">
                        <h4 class="text-xl font-semibold text-white flex items-center">
                            <i class="fas fa-running text-blue-400 mr-2"></i>
                            Melhores Laterais
                        </h4>
                    </div>
                    <div class="p-4">
                        <div class="overflow-x-auto">
                            {{ tables.laterais | safe if tables.laterais else '<p class="text-dark-blue-400 text-center py-4">Nenhum dado disponível</p>' }}
                        </div>
                    </div>
                </div>

                <!-- Center Backs -->
                <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-xl border border-dark-blue-700/50 shadow-lg">
                    <div class="p-4 border-b border-dark-blue-700/50">
                        <h4 class="text-xl font-semibold text-white flex items-center">
                            <i class="fas fa-shield-alt text-red-400 mr-2"></i>
                            Melhores Zagueiros
                        </h4>
                    </div>
                    <div class="p-4">
                        <div class="overflow-x-auto">
                            {{ tables.zagueiros | safe if tables.zagueiros else '<p class="text-dark-blue-400 text-center py-4">Nenhum dado disponível</p>' }}
                        </div>
                    </div>
                </div>

                <!-- Midfielders -->
                <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-xl border border-dark-blue-700/50 shadow-lg">
                    <div class="p-4 border-b border-dark-blue-700/50">
                        <h4 class="text-xl font-semibold text-white flex items-center">
                            <i class="fas fa-futbol text-purple-400 mr-2"></i>
                            Melhores Meias
                        </h4>
                    </div>
                    <div class="p-4">
                        <div class="overflow-x-auto">
                            {{ tables.meias | safe if tables.meias else '<p class="text-dark-blue-400 text-center py-4">Nenhum dado disponível</p>' }}
                        </div>
                    </div>
                </div>

                <!-- Forwards -->
                <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-xl border border-dark-blue-700/50 shadow-lg">
                    <div class="p-4 border-b border-dark-blue-700/50">
                        <h4 class="text-xl font-semibold text-white flex items-center">
                            <i class="fas fa-bullseye text-orange-400 mr-2"></i>
                            Melhores Atacantes
                        </h4>
                    </div>
                    <div class="p-4">
                        <div class="overflow-x-auto">
                            {{ tables.atacantes | safe if tables.atacantes else '<p class="text-dark-blue-400 text-center py-4">Nenhum dado disponível</p>' }}
                        </div>
                    </div>
                </div>

                <!-- Coaches -->
                <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-xl border border-dark-blue-700/50 shadow-lg">
                    <div class="p-4 border-b border-dark-blue-700/50">
                        <h4 class="text-xl font-semibold text-white flex items-center">
                            <i class="fas fa-user-tie text-indigo-400 mr-2"></i>
                            Melhores Treinadores
                        </h4>
                    </div>
                    <div class="p-4">
                        <div class="overflow-x-auto">
                            {{ tables.treinadores | safe if tables.treinadores else '<p class="text-dark-blue-400 text-center py-4">Nenhum dado disponível</p>' }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Execution Log -->
        {% if output %}
        <div class="mt-12">
            <div class="flex items-center space-x-3 mb-6">
                <div class="p-2 bg-gradient-to-br from-gray-500 to-gray-600 rounded-lg">
                    <i class="fas fa-terminal text-white"></i>
                </div>
                <h3 class="text-2xl font-bold text-white">Log de Execução</h3>
            </div>
            
            <div class="bg-gray-900/50 backdrop-blur-sm rounded-xl border border-gray-700/50 shadow-lg">
                <div class="p-4 border-b border-gray-700/50">
                    <h4 class="text-lg font-semibold text-gray-200">Console Output</h4>
                </div>
                <div class="p-4">
                    <pre class="text-sm text-gray-300 whitespace-pre-wrap font-mono overflow-x-auto">{{ output }}</pre>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
{% endif %}

<style>
/* Custom styles for tables within the rankings */
.table {
    @apply text-dark-blue-100;
}
.table th {
    @apply bg-dark-blue-700/50 text-dark-blue-200 border-dark-blue-600/50;
}
.table td {
    @apply border-dark-blue-700/30;
}
.table-striped tbody tr:nth-of-type(odd) {
    @apply bg-dark-blue-800/20;
}
.table-hover tbody tr:hover {
    @apply bg-dark-blue-700/30;
}
</style>
{% endblock %}