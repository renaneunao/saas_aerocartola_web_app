{% extends "base.html" %}
{% block title %}Prováveis - Cartola FC Manager{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="text-center mb-8">
    <div class="flex items-center justify-center space-x-3 mb-4">
        <div class="p-3 bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg animate-pulse-glow">
            <i class="fas fa-users text-2xl text-white"></i>
        </div>
        <h1 class="text-4xl font-bold bg-gradient-to-r from-white to-green-200 bg-clip-text text-transparent">
            Prováveis Cartola
        </h1>
    </div>
    <div class="flex items-center justify-center space-x-2 text-dark-blue-200">
        <i class="fas fa-link"></i>
        <span class="text-lg">Nova API - Dados Atualizados</span>
    </div>
</div>

{% if not clubes %}
    <!-- No Data State -->
    <div class="max-w-2xl mx-auto text-center">
        <div class="bg-gradient-to-br from-yellow-900/50 to-orange-900/50 backdrop-blur-sm rounded-2xl p-8 border border-yellow-500/50">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-yellow-500/20 rounded-full mb-4">
                <i class="fas fa-exclamation-triangle text-yellow-400 text-2xl"></i>
            </div>
            <h3 class="text-xl font-semibold text-yellow-200 mb-2">Nenhum dado encontrado</h3>
            <p class="text-yellow-300/80 mb-6">Execute a atualização dos dados primeiro para ver os prováveis jogadores.</p>
            <a href="{{ url_for('pagina_inicial') }}" class="inline-flex items-center space-x-2 bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 transform hover:scale-105">
                <i class="fas fa-sync"></i>
                <span>Configurar Sistema</span>
            </a>
        </div>
    </div>
{% else %}
    <!-- Statistics Cards -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        <div class="bg-gradient-to-br from-green-800/50 to-green-900/50 backdrop-blur-sm rounded-xl p-6 border border-green-500/50 text-center">
            <div class="inline-flex items-center justify-center w-12 h-12 bg-green-500/20 rounded-full mb-3">
                <i class="fas fa-check-circle text-green-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-bold text-green-300 mb-1">{{ clubes|sum(attribute='total_provaveis') }}</div>
            <div class="text-green-200 text-sm">Prováveis</div>
        </div>

        <div class="bg-gradient-to-br from-yellow-800/50 to-yellow-900/50 backdrop-blur-sm rounded-xl p-6 border border-yellow-500/50 text-center">
            <div class="inline-flex items-center justify-center w-12 h-12 bg-yellow-500/20 rounded-full mb-3">
                <i class="fas fa-exclamation-triangle text-yellow-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-bold text-yellow-300 mb-1">{{ clubes|sum(attribute='total_suspensos') }}</div>
            <div class="text-yellow-200 text-sm">Suspensos</div>
        </div>

        <div class="bg-gradient-to-br from-red-800/50 to-red-900/50 backdrop-blur-sm rounded-xl p-6 border border-red-500/50 text-center">
            <div class="inline-flex items-center justify-center w-12 h-12 bg-red-500/20 rounded-full mb-3">
                <i class="fas fa-ambulance text-red-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-bold text-red-300 mb-1">{{ clubes|sum(attribute='total_lesionados') }}</div>
            <div class="text-red-200 text-sm">Lesionados</div>
        </div>

        <div class="bg-gradient-to-br from-blue-800/50 to-blue-900/50 backdrop-blur-sm rounded-xl p-6 border border-blue-500/50 text-center">
            <div class="inline-flex items-center justify-center w-12 h-12 bg-blue-500/20 rounded-full mb-3">
                <i class="fas fa-futbol text-blue-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-bold text-blue-300 mb-1">{{ clubes|length }}</div>
            <div class="text-blue-200 text-sm">Clubes</div>
        </div>
    </div>

    <!-- Clubs List -->
    <div class="space-y-4">
        {% for clube in clubes %}
        <div class="bg-gradient-to-br from-dark-blue-800/50 to-dark-blue-900/50 backdrop-blur-sm rounded-xl border border-dark-blue-700/50 shadow-lg overflow-hidden">
            <!-- Club Header -->
            <div class="club-header bg-gradient-to-r from-dark-blue-700/80 to-dark-blue-800/80 p-4 cursor-pointer hover:from-dark-blue-600/80 hover:to-dark-blue-700/80 transition-all duration-200"
                 onclick="toggleClub({{ clube.clube_id }})">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg">
                            <i class="fas fa-shield-alt text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-white">{{ clube.clube_nome }}</h3>
                            <span class="inline-flex items-center px-2 py-1 bg-blue-500/20 text-blue-300 rounded-full text-sm border border-blue-500/50">
                                {{ clube.clube_abrev }}
                            </span>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        {% if clube.total_provaveis > 0 %}
                        <span class="inline-flex items-center px-3 py-1 bg-green-500/20 text-green-300 rounded-full text-sm border border-green-500/50">
                            <i class="fas fa-check-circle mr-1"></i>
                            {{ clube.total_provaveis }} Prováveis
                        </span>
                        {% endif %}
                        
                        {% if clube.total_suspensos > 0 %}
                        <span class="inline-flex items-center px-3 py-1 bg-yellow-500/20 text-yellow-300 rounded-full text-sm border border-yellow-500/50">
                            <i class="fas fa-exclamation-triangle mr-1"></i>
                            {{ clube.total_suspensos }} Suspensos
                        </span>
                        {% endif %}
                        
                        {% if clube.total_lesionados > 0 %}
                        <span class="inline-flex items-center px-3 py-1 bg-red-500/20 text-red-300 rounded-full text-sm border border-red-500/50">
                            <i class="fas fa-ambulance mr-1"></i>
                            {{ clube.total_lesionados }} Lesionados
                        </span>
                        {% endif %}
                        
                        <div class="transform transition-transform duration-200" id="arrow-{{ clube.clube_id }}">
                            <i class="fas fa-chevron-down text-dark-blue-300"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Club Content (Initially Hidden) -->
            <div class="club-content hidden" id="content-{{ clube.clube_id }}">
                <div class="p-6 space-y-6">
                    
                    <!-- Probable Players -->
                    {% if clube.jogadores.provavel %}
                    <div>
                        <div class="flex items-center space-x-2 mb-4">
                            <div class="p-2 bg-green-500/20 rounded-lg">
                                <i class="fas fa-check-circle text-green-400"></i>
                            </div>
                            <h4 class="text-lg font-semibold text-white">
                                Prováveis ({{ clube.jogadores.provavel|length }})
                            </h4>
                        </div>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                            {% for jogador in clube.jogadores.provavel %}
                            <div class="bg-gradient-to-br from-green-800/30 to-green-900/30 rounded-lg p-3 border border-green-500/30 hover:border-green-400/50 transition-all duration-200 hover:transform hover:scale-105">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-green-200">{{ jogador.apelido }}</div>
                                        <div class="text-green-300/80 text-sm">{{ jogador.posicao_nome or 'N/A' }}</div>
                                    </div>
                                    <div class="w-8 h-8 bg-green-500/20 rounded-full flex items-center justify-center">
                                        <i class="fas fa-check text-green-400 text-sm"></i>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    <!-- Suspended Players -->
                    {% if clube.jogadores.suspenso %}
                    <div>
                        <div class="flex items-center space-x-2 mb-4">
                            <div class="p-2 bg-yellow-500/20 rounded-lg">
                                <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                            </div>
                            <h4 class="text-lg font-semibold text-white">
                                Suspensos ({{ clube.jogadores.suspenso|length }})
                            </h4>
                        </div>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                            {% for jogador in clube.jogadores.suspenso %}
                            <div class="bg-gradient-to-br from-yellow-800/30 to-yellow-900/30 rounded-lg p-3 border border-yellow-500/30 hover:border-yellow-400/50 transition-all duration-200 hover:transform hover:scale-105">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-yellow-200">{{ jogador.apelido }}</div>
                                        <div class="text-yellow-300/80 text-sm">{{ jogador.posicao_nome or 'N/A' }}</div>
                                    </div>
                                    <div class="w-8 h-8 bg-yellow-500/20 rounded-full flex items-center justify-center">
                                        <i class="fas fa-ban text-yellow-400 text-sm"></i>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    <!-- Injured Players -->
                    {% if clube.jogadores.lesionado %}
                    <div>
                        <div class="flex items-center space-x-2 mb-4">
                            <div class="p-2 bg-red-500/20 rounded-lg">
                                <i class="fas fa-ambulance text-red-400"></i>
                            </div>
                            <h4 class="text-lg font-semibold text-white">
                                Lesionados ({{ clube.jogadores.lesionado|length }})
                            </h4>
                        </div>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3">
                            {% for jogador in clube.jogadores.lesionado %}
                            <div class="bg-gradient-to-br from-red-800/30 to-red-900/30 rounded-lg p-3 border border-red-500/30 hover:border-red-400/50 transition-all duration-200 hover:transform hover:scale-105">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-red-200">{{ jogador.apelido }}</div>
                                        <div class="text-red-300/80 text-sm">{{ jogador.posicao_nome or 'N/A' }}</div>
                                    </div>
                                    <div class="w-8 h-8 bg-red-500/20 rounded-full flex items-center justify-center">
                                        <i class="fas fa-plus text-red-400 text-sm"></i>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}

                    <!-- Last Update -->
                    {% if clube.ultima_atualizacao %}
                    <div class="pt-4 border-t border-dark-blue-700/50">
                        <div class="flex items-center space-x-2 text-dark-blue-300 text-sm">
                            <i class="fas fa-clock"></i>
                            <span>Última atualização: {{ clube.ultima_atualizacao }}</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Info Section -->
    <div class="mt-12">
        <div class="bg-gradient-to-br from-blue-900/50 to-indigo-900/50 backdrop-blur-sm rounded-2xl p-6 border border-blue-500/50">
            <div class="flex items-start space-x-4">
                <div class="p-2 bg-blue-500/20 rounded-lg">
                    <i class="fas fa-info-circle text-blue-400 text-xl"></i>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-white mb-4">Sobre os dados</h3>
                    <div class="grid md:grid-cols-2 gap-4 text-blue-200">
                        <div>
                            <h4 class="font-medium text-blue-100 mb-2">
                                <i class="fas fa-link text-blue-400 mr-2"></i>
                                Fonte dos Dados
                            </h4>
                            <p class="text-sm">API: https://www.provaveisdocartola.com.br/data/desfalques.json</p>
                        </div>
                        
                        <div>
                            <h4 class="font-medium text-blue-100 mb-2">
                                <i class="fas fa-check-circle text-blue-400 mr-2"></i>
                                Prováveis
                            </h4>
                            <p class="text-sm">Jogadores que devem jogar na próxima rodada segundo análises especializadas.</p>
                        </div>
                        
                        <div>
                            <h4 class="font-medium text-blue-100 mb-2">
                                <i class="fas fa-exclamation-triangle text-blue-400 mr-2"></i>
                                Suspensos
                            </h4>
                            <p class="text-sm">Jogadores que não podem jogar por suspensão disciplinar ou acúmulo de cartões.</p>
                        </div>
                        
                        <div>
                            <h4 class="font-medium text-blue-100 mb-2">
                                <i class="fas fa-ambulance text-blue-400 mr-2"></i>
                                Lesionados
                            </h4>
                            <p class="text-sm">Jogadores afastados por lesão ou problemas físicos.</p>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-3 bg-blue-800/30 rounded-lg border border-blue-500/30">
                        <div class="flex items-center space-x-2 text-blue-200">
                            <i class="fas fa-sync text-blue-400"></i>
                            <span class="text-sm">Os dados são atualizados automaticamente a cada execução do sistema</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endif %}

<script>
function toggleClub(clubId) {
    const content = document.getElementById(`content-${clubId}`);
    const arrow = document.getElementById(`arrow-${clubId}`);
    
    if (content.classList.contains('hidden')) {
        // Show content
        content.classList.remove('hidden');
        content.style.maxHeight = content.scrollHeight + 'px';
        arrow.style.transform = 'rotate(180deg)';
        
        // Add slide-down animation
        content.style.opacity = '0';
        content.style.transform = 'translateY(-10px)';
        
        setTimeout(() => {
            content.style.transition = 'opacity 0.3s ease-out, transform 0.3s ease-out';
            content.style.opacity = '1';
            content.style.transform = 'translateY(0)';
        }, 10);
    } else {
        // Hide content
        content.style.transition = 'opacity 0.3s ease-out, transform 0.3s ease-out';
        content.style.opacity = '0';
        content.style.transform = 'translateY(-10px)';
        arrow.style.transform = 'rotate(0deg)';
        
        setTimeout(() => {
            content.classList.add('hidden');
            content.style.maxHeight = '0';
        }, 300);
    }
}

// Add smooth scroll for better UX
document.querySelectorAll('.club-header').forEach(header => {
    header.addEventListener('click', function() {
        this.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    });
});
</script>
{% endblock %}